## Quick Guide: How the Sensitivities are Calculated and Used

This repository contains all strain sensitivity calculations and notebooks used to model the **high-frequency response of GEO600** and compare it to aLIGO and Cosmic Explorer.  
Below is a detailed explanation of how the sensitivity arrays are generated, sky-averaged, and applied in different figures.

---

### NPZ File of Sensitivities:

The file `ASD_50W_100000_05.npz` contains multiple **strain sensitivity arrays**, all given as **Amplitude Spectral Densities (ASDs)**.  
Each array is accessed by its key name (as seen in the notebooks).

Included in the NPZ file:
- The **frequency array** used for all sensitivities.
- **Sky-averaged strain sensitivities** for GEO600 at integer MSR detuning angles from 0° (tuned) to 90° (anti-tuned).
- The **sky-averaged scanned strain sensitivity** for GEO600, which is a summation of all possible MSR detuning angle configurations.
- **Design strain sensitivities** for the tuned configurations of aLIGO and Cosmic Explorer (CE), generated by **PyGWINC**. Note, the tuned configuration of aLIGO is at a MSR detuning angle of $\phi = 90$.

All **GEO600 sensitivities** in the NPZ file are sky-averaged by multiplying the transfer function Finesse calculates by GEO's sky-averaged antenna pattern array, 
and dividing by GEO's normal-incidence antenna pattern array (canceling the antenna pattern Finesse implements):

$$
\left\langle \frac{\partial P}{\partial h} \right\rangle = \frac{\partial P}{\partial h}\biggr |_{\texttt{Finesse}}\!\!\!\times \frac{\mathcal{R}(f)}{\left|F_+^\mathrm{fold}\left(f,\hat n = \hat z\right)\right|}.
$$

This is the same as multiplying the normal-incidence strain sensitivity Finesse calculates by the inverse:

$$
\langle A_h(f_0) \rangle = A_h(f_0)\frac{\left|F_+^\mathrm{fold}\left(f,\hat n = \hat z\right)\right|}{\mathcal{R}(f_0)},
$$

which is the method used from now on.

For **aLIGO** and **CE**, sensitivities are produced by PYGWINC without any antenna pattern applied; i.e., they assume no GW incidence and are not sky-averaged.

The NPZ file, and all arrays included in it, are generated in the notebook
> `GEO Optimization.ipynb`

---

### Sensitivities Used in Figures 2, 3, 4, and 6:

The sensitivities used in Figures 2–4 and 6 in the paper correspond to **directional (non-sky-averaged)** responses. Each GEO600 array from the NPZ file is multiplied by 
$\frac{\mathcal{R}(f)}{\left|F_+^\mathrm{fold}\left(f, \theta_{\hat n} = 15, \phi_{\hat n} = 0 \right)\right|}$ to get the
strain sensitivity assuming a GW incident from \theta_{\hat n} = 15^\circ overhead.

For **aLIGO** and **CE**, the antenna pattern is applied by multiplying the strain sensitivity arrays by 
$\frac{1}{\left|F_+^\mathrm{fold}\left(f, \theta_{\hat n} = 15, \phi_{\hat n} = 0 \right)\right|}$,
so all detectors are normalized to the same GW incidence direction.

---

### Sensitivities Used in Figure 5 and SNR Calculations:

For **Figure 5** in the paper, and all **Signal-to-Noise Ratio (SNR)** calculations, the **sky-averaged strain sensitivities** are used.

- For **GEO600**, these are directly from the NPZ file (already sky-averaged).
- For **aLIGO** and **CE**, the antenna pattern is applied by multiplying the strain sensitivity by $\frac{1}{\mathcal{R}(f)}$.

---

### Sensitivities Used in Figure 8 (Noise Budget):

The sensitivities in **Figure 8** in the paper, which is the GEO Noise Budget notebook, are not imported from the NPZ file. 
Each individual noise curve, as well as the total strain sensitivity, is computed in **Finesse**, which assumes a **normal-incident GW** antenna pattern.  
The total sky-averaged strain sensitivity is obtained by multiplying the total strain sensitivity for normal incidence by 
$\frac{\left|F_+^\mathrm{fold}\left(f,\hat n = \hat z\right)\right|}{\mathcal{R}(f_0)}$.
